---
title: 2020_榮耀資戰
date: 2020-07-25 19:53:08
tags:
- record
- summer vacation
- koth
- ctf
thumbnailImage: https://t.kfs.io/upload_images/110470/_______-_____Banner_1200x630_large.jpg
thumbnailImagePosition: right
---

2020 合勤榮耀資戰比賽紀錄
<!-- excerpt -->

# 2020 合勤榮耀資戰 - 決賽

## 比賽規則

- 地點: 台北文創六樓
- 形式: King of the hill CTF
- 三階段開啟機器
    - 第一階段: 50台
    - 第二階段: 30台
    - 第三階段: 20台
    - 一組有5組ip可以做使用
    - 進階組則有兩個網段
- 每組有一組字串(token)作為識別，需要將東西寫到網頁(web:80 port)根目錄上，系統會每分鐘去監測該段token是否存在，占領一分鐘得一分
- 並無限制封鎖服務，也就是說**可以**把該主機原本預計有的漏洞服務關掉，讓別人根本打不進來((結果導致大就用iptable來ban
- 在同網段，弱點偵測(阿怎麼都try弱密碼)、系統入侵(腳本小子大賽)、漏洞防護(關服務囉)

##  Day1

### 早上

- 主要就一些長官來致詞，寒暄一下，以及講解規則
- 先拿`nmap`開掃，然後看到幾台有80的就先打打看
    - 最一開始還有wordpress、xampp站的形狀，摸到一半整台就被佔走了
    - 有個奇怪的站，裡面就`xss`、`sqli`那些經典漏洞，不過嘗試過用`;`來做stack-based sqli，都一直失敗，眼睜睜的看著別人在首頁寫下`script`，直接佔走首頁的留言板，望塵莫及
    - 還有一些IIS、apache、nginx的default page，不過都沒什麼想法，後來很像幾乎都是80的洞，聽說大部分都是`ssh`爆破弱密碼之類的...
    - 打到累就吃個便當跟餅乾
- 結果早上都沒拿到半台機器，只能眼睜睜看著別人在榜上一直上上下下

### 下午

- 看著大家逐漸佔下機器，看看掃到的那些ip，丟上去幾乎都被別人佔走，不然就是掛掉，幾乎都沒辦法打了
- 後來開了第二波機器，看到有開`3389`跟`445`，就google看看有沒有windows的exploit來試試，不過似乎都沒有
    - 大概在結束個前兩個小時，被我試到`MS17-010`(永恆之藍)的`exploit`能成功打進去，成功拿到`meterpreter`的`shell`
    - 拿到`shell`之後，我們討論的做法是先將token寫到網頁根目錄，接下來想辦法把能關的服務都關掉，想辦法開防火牆
        - 看到這篇文: https://www.freebuf.com/articles/web/208598.html
- 不過事情沒那麼簡單，我們都不熟windows，又加上只有cli
    - 首先要找到webroot，就查了一堆文章，原先以為webroot是在tomcat資料夾裡面，後來找到只要將檔案寫到`C:\inetpub\wwwroot`裡面，檔案名稱叫`index.html`
    - 接著想辦法要開防火牆，有找到幾command以為是設定防火牆，結果回家才發現只是設定防火牆的規則，根本沒開。不過這台都沒人打進來，卑鄙源之助
        - 而且windows還將防火牆分三層(私人、公用...甚麼的)，也不知道到底開哪層
    - 中間斷斷續續的遇到shell斷掉，有時打得進去打不進去的狀況
- 後來又發現有兩台根本一模一樣的洞，在`80`port，是`403 forbiddent`的頁面
    - 就按照流程一次，讓我們靠一個exploit，同時能有三台機器在上面賺分數
    - 不過時間很像也快結束，所以很像也只賺個100分左右


## Day2

### 早上

- 隔天早上一來，比賽一開始還發現機器都還活著，還幫我們賺了一些分數
    - 不過後來快到中午很像有被別人打掛，或者是機器當機，不確定原因，但我也進不去shell，所以我也不清楚實際上發生甚麼事
- 後來到中午又陸陸續續開了20台吧，因為題目重複的關係，導致那些原本有exploit就照做，而我依然只能看著80放著別人的flag，加上有將近一半的機器都被打掛或是被佔走換了密碼，也不知道要打甚麼
- 另外還有遇到進的去shell，但甚麼都打不進去的狀況，後來感覺像是[honeypot](https://zh.wikipedia.org/wiki/%E8%9C%9C%E7%BD%90_(%E9%9B%BB%E8%85%A6%E7%A7%91%E5%AD%B8))，很像被別人耍成白癡一樣


### 下午

- 我還多掙扎了幾下，盡量找找看有甚麼其他port有甚麼exploit，不過try都失敗
- 果斷開啟跑跑來玩，排位打起來，直接放棄


## 心得

- 第一次體驗這種形式的ctf還蠻好玩的，不過因為比賽規則的關係，讓大家普遍都覺得失去King of the hill的意義，很像失去了原本ctf應有的品質
- 以下列出幾項我覺得能改善的部分(不過我認為有些真的要做到也有一定難度)
    - 並無限制伺服器服務(service)的完整性，導致大家進去就關服務關Port，不然就將防火牆打開，讓大家根本沒有機會再打進來
        - 我自認為有點像是大家預定要在山上格鬥，結果先到的那個人直接把要格鬥的場地直接圍起來，讓大家都不要進來，直接在裡面稱霸
    - 太多靶機幾乎完全相同，讓原本打到洞的人可以持續佔領，讓別人也無法動那台
    - 第一天一直放相同的歌單，很像只loop三首吧。不過到了第二天雖然歌單有換，但很像就是一直The future, gay gay gay i i呵呵(求歌單)，還看到其他組的人跟著空耳
    - 運氣成分大於技術部分，很像也不是ctf應該有的情況
- 不過主辦單位認為，這是為了符合社會現實情況，實際的機器也有可能在其他地方找到相同，而且也並無限制使用一些防禦機制
    - 我個人認為這已經失去了king of the hill的原本目的了啦哈哈
- 在頒獎典禮的過程，也有一些小插曲，我就不方便陳述太多細節了，很像增添了比賽的一點樂趣((誤
- 雖然初賽很像吊車尾進去決賽的，不過進去還能夠拿個第九，很像還可以啦哈哈，雖然就只試到一個exploit而已

## 照片記錄

[我都放在這了](https://photos.app.goo.gl/TDsrgFK1LMjHDQP67)

